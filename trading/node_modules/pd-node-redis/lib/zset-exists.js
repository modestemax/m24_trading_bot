'use strict';
var q = require('q');
var exec = require('./exec');
var announcer = require('pd-api-announcer');
var defaultCli = require('./default-cli');

module.exports = function (zsetKey, itemToMatch, cli) {
    var client = cli || defaultCli;
    return q.Promise(function (resolve, reject) {
        exec('zscan', [zsetKey, 0, 'match', itemToMatch], client)
            .then(function (reply) {
                if (!reply[1] || reply[1][0] !== itemToMatch) {
                    throw announcer.error.sys('zsetItem', 'gone');
                }
                resolve(reply);
            }).fail(function (err) {
                reject(err);
            });
    });
};
