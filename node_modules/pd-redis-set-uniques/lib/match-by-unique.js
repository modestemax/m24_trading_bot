'use strict';
var redisUti = require('pd-node-redis');

module.exports = function (Record, uniqDef, matchPattern, cursor, count) {
    var cur = cursor || 0;
    var cnt = count || 10;
    return Record.redis.exec('zscan', [Record.uniqNm.uniqSetOf(uniqDef), cur,
        'match', matchPattern, 'count', cnt]).then(function (results) {
        return {
            cursor: results[0],
            records: redisUti.converters.z2aWithScore(results[1])
        };
    });
};
