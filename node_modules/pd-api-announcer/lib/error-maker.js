'use strict';
var _ = require('underscore');

var exception;
module.exports = exception = function (field, message, code, errorValue) {
    var error = new Error('pdnError:' + field + ':' + message);
    _.extend(error, {
        isPdn: true,
        errors: {},
        status: codeFilter(code)
    });
    error.errors[field] = {message: message, value: errorValue};
    return error;
};

_.extend(module.exports, {
    req: function (field, message, value) {
        return exception(field || 'pdn-req', message, 403, value);
    },
    sys: function (field, message, value) {
        return exception(field || 'pdn-sys', message, 500, value);
    }
});

_.extend(module.exports, {
    sysMessage: function (message) {
        return exception.sys(null, message);
    }
});

function codeFilter(code) {
    return code || 500;
}
