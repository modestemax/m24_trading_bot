'use strict';
var extRemove = require('./lib/extends-remove');
var extAbandon = require('./lib/extends-abandon');
var extBeKidOf = require('./lib/extends-be-kid-of');
var extGetParent = require('./lib/extends-get-parent');
var nomen = require('./lib/nomenclt');

module.exports = function (Child, Parent) {
    var flagName = 'isKidOf' + Parent.modelName();
    if (!Child.isRedisModel || Child[flagName]) {
        return;
    }
    extRemove(Child, Parent);
    extAbandon(Child, Parent);
    extBeKidOf(Child, Parent);
    extGetParent(Child, Parent);

    Child[Parent.modelName() + 'Kid'] = function (childSid) {
        var cSid = (childSid + '').trim();
        return {
            abandon: function (parentSid) {
                var abandonName = nomen.abandon(Parent);
                return Child[abandonName](cSid, parentSid);
            },
            beKidOf: function (parentSid) {
                var beKidName = nomen.beKidOf(Parent);
                return Child[beKidName](cSid, parentSid);
            },
            getParent: function (option) {
                var getParentName = nomen.getParent(Parent);
                return Child[getParentName](cSid, option);
            }
        };
    };

    Child[flagName] = true;
};