'use strict';
var z2aWithScore = require('./converter').z2aWithScore;
var exec = require('./exec');
var defaultCli = require('./default-cli');

module.exports = function (key, option, cli) {
    var opt = option || {};
    var latest = opt.latest;
    var earliest = opt.earliest;
    var redisArgs = [key, latest, earliest, 'WITHSCORES'];
    var limit = opt.limit;
    if (limit) {
        redisArgs.splice(4, 0, 'LIMIT', limit[0], limit[1]);
    }
    return exec('zrevrangebyscore', redisArgs, cli || defaultCli).then(function (reply) {
        return z2aWithScore(reply);
    });
};